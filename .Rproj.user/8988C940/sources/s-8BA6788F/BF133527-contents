# process data for analysis

# load libs
library(data.table)

# read raw data
data <- data.table::fread("data/ILINet.csv", skip = 1)

# specify period of time: November to whatever max week in winter we are
  # winter cutoff point, early APRIL ~ week 16
  # falL, last 10 weeks (week 42 - week 52)
  # data in 2020 is incomplete for winter: subset all years for whichever max week 2020 has
winterWks <- data[WEEK <=16L & YEAR == 2020L, unique(WEEK)]
fallWks <- 42:52

# subset data
d1 <- data[WEEK %in% fallWks | WEEK %in% winterWks, ]

# select cols 
cols <- c("REGION", "YEAR", "WEEK", "ILITOTAL")

d2 <- d1[, cols, with=FALSE]

saveRDS(d2, "data/data_processed.RDS")